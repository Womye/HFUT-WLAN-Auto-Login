1. **è‡ªåŠ¨åˆ¤æ–­æ˜¯å¦æ’ç½‘çº¿**
2. **æ’ç½‘çº¿ â†’ è°ƒç”¨ä½ ä¹‹å‰ç”¨çš„ Drcom ç™»å½•è„šæœ¬**
3. **æœªæ’ç½‘çº¿ â†’ è‡ªåŠ¨è¿æ¥ hfut-wlan + è‡ªåŠ¨æäº¤è®¤è¯ï¼ˆæ¨¡æ‹Ÿæµè§ˆå™¨ç™»å½•ï¼‰**
4. **é™é»˜è¿è¡Œï¼ˆæ— é»‘æ¡†ï¼‰**
5. **å¼€æœºè‡ªå¯åŠ¨è®¾ç½®æ–¹æ³•ï¼ˆä¸€æ­¥åˆ°ä½ï¼‰**

------

# ğŸŒŸ **ä¸€ã€**å®Œæ•´ Python è‡ªåŠ¨ç™»å½•è„šæœ¬ï¼ˆç½‘çº¿ + WiFi å…¨è‡ªåŠ¨ï¼‰

å¯ä»¥ç›´æ¥ä¸‹è½½ä¸Šä¼ å¥½çš„è„šæœ¬ä¹Ÿå¯ä»¥å¤åˆ¶ä»£ç è‡ªå·±åˆ›å»ºæ–‡ä»¶

PASSWORD_MD5è¿™ä¸€é¡¹è¯·æŒ‰ç…§ä»¥ä¸‹æ“ä½œï¼ˆä¸€æ­¥æ­¥ç…§åšï¼‰

## â–² 1. æ‰“å¼€ http://172.18.3.3

æµè§ˆå™¨ç›´æ¥è®¿é—®ä½ çš„æ ¡å›­ç½‘è®¤è¯ç•Œé¢ã€‚

## â–² 2. æŒ‰ F12 â†’ Network(ç½‘ç»œ)

æ¸…ç©ºä¸€ä¸‹åˆ—è¡¨ã€‚

## â–² 3. è¾“å…¥å­¦å· + å¯†ç  â†’ ç‚¹å‡»ç™»å½•

ç„¶åè§‚å¯Ÿ Network ä¸­æœ‰**çº¢è‰²/ç»¿è‰²/POST/GET è¯·æ±‚**å‡ºç°ã€‚

## â–² 4. æ‰¾åˆ°çœŸæ­£çš„ç™»å½•è¯·æ±‚ï¼ˆéå¸¸å…³é”®ï¼‰

- ### åœ¨ Network ä¸­ç‚¹å‡» `0.htm` ä¹‹å

  ä¸Šæ–¹æœ‰å‡ ä¸ªæ ‡ç­¾ï¼š

  - æ ‡å¤´ï¼ˆHeadersï¼‰
  - **è½½è· / Payloadï¼ˆæˆ– Form Dataï¼‰**
  - é¢„è§ˆï¼ˆPreviewï¼‰
  - å“åº”ï¼ˆResponseï¼‰
  - å¯åŠ¨å™¨ï¼ˆInitiatorï¼‰
  - æ—¶é—´ï¼ˆTimingï¼‰

  ğŸ‘‰ **çœŸæ­£çš„è´¦å·å¯†ç å‚æ•°åœ¨ Payload é‡Œã€‚** 

  1. åœ¨ Network ä¸­ç‚¹é€‰ **0.htm**
  2. åœ¨å³è¾¹çš„é¢æ¿ç‚¹å¼€ **è½½è·ï¼ˆPayloadï¼‰**
     - æœ‰çš„æµè§ˆå™¨å« **Form Data**
     - æœ‰çš„å« **Request Payload**
  3. æ‰¾åˆ°**upass**è¿™ä¸€é¡¹ï¼Œå³é”®å¤åˆ¶å€¼ï¼Œè¿™å°±æ˜¯PASSWORD_MD5çš„æ•°æ®

```python
import subprocess
import requests
import time
import os
import sys
import ctypes

# =========== ä½ çš„ç™»å½•ä¿¡æ¯ï¼ˆä¿®æ”¹è¿™é‡Œï¼‰ ==========
USERNAME = "ä½ çš„å­¦å·"
PASSWORD_MD5 = "æ§åˆ¶å°ä¸­å·²åŠ å¯†çš„å¯†ç "
OMKKEY = "123456"

WIFI_NAME = "hfut-wlan"
DRCOM_URL = "http://172.18.3.3/0.htm"
# =================================================


# ------- åˆ¤æ–­æ˜¯å¦æ’ç½‘çº¿ -------
def ethernet_connected():
    try:
        output = subprocess.check_output(
            'powershell "Get-NetAdapter | Where-Object {$_.Status -eq \'Up\'} | Select-Object -ExpandProperty InterfaceDescription"',
            shell=True, encoding='gbk', errors='ignore'
        )
        return ("Realtek" in output) or ("Ethernet" in output) or ("PCIe" in output)
    except:
        return False


# ------- è¿æ¥æ ¡å›­ç½‘ WiFi -------
def connect_wifi():
    print("æ­£åœ¨è¿æ¥æ ¡å›­ç½‘ WiFi ...")

    cmd = f'netsh wlan connect name="{WIFI_NAME}"'
    try:
        subprocess.run(cmd, shell=True, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)
        time.sleep(3)
        return True
    except:
        return False


# ------- WiFi ç™»å½•è®¤è¯ï¼ˆæ¨¡æ‹Ÿæµè§ˆå™¨ï¼‰ -------
def wifi_login():
    print("æ­£åœ¨è¿›è¡Œ WiFi è®¤è¯ ...")

    login_url = DRCOM_URL

    data = {
        "DDDDD": USERNAME,
        "upass": PASSWORD_MD5,
        "R1": "0",
        "R2": "1",
        "para": "00",
        "0MKKey": OMKKEY
    }

    try:
        r = requests.post(login_url, data=data, timeout=5)
        if r.status_code == 200:
            print("WiFi ç™»å½•æˆåŠŸ!")
            return True
        else:
            print("WiFi ç™»å½•å¤±è´¥!!")
    except:
        pass

    return False


# ------- ç½‘çº¿ç™»å½•ï¼ˆè°ƒç”¨ Drcomï¼‰ -------
def ethernet_login():
    print("æ­£åœ¨è¿›è¡Œæœ‰çº¿ Drcom ç™»å½•...")

    data = {
        "DDDDD": USERNAME,
        "upass": PASSWORD_MD5,
        "R1": "0",
        "R2": "1",
        "para": "00",
        "0MKKey": OMKKEY
    }

    try:
        r = requests.post(DRCOM_URL, data=data, timeout=5)
        if r.status_code == 200:
            print("æœ‰çº¿ç™»å½•æˆåŠŸ!")
            return True
    except:
        pass

    print("æœ‰çº¿ç™»å½•å¤±è´¥!")
    return False


# ------------------- å…¥å£ -------------------
def main():
    # é™é»˜
    if not sys.stdout.isatty():
        pass

    if ethernet_connected():
        ethernet_login()
    else:
        connect_wifi()
        time.sleep(2)
        wifi_login()


if __name__ == "__main__":
    main()
```

------

# ğŸ“Œ **äºŒã€æŠŠè„šæœ¬æ‰“åŒ…æˆé™é»˜ exeï¼ˆè¦å…ˆå®‰è£…Pythonï¼‰**

åœ¨é”®ç›˜ä¸ŠæŒ‰WIN + Ræ‰“å¼€cmdå…ˆå®‰è£…ï¼š

```bash
pip install pyinstaller
```

æ¥ç€åœ¨auto_hfut_login.pyæ‰€åœ¨æ–‡ä»¶å¤¹æŒ‰**Shift+å³é”®**ï¼Œé€‰æ‹©åœ¨æ­¤å¤„æ‰“å¼€Powershellï¼Œç„¶åè¾“å…¥ï¼š

```bash
pyinstaller --noconsole --onefile auto_hfut_login.py
```

ç”Ÿæˆæ–‡ä»¶åœ¨ï¼š

```
dist/auto_hfut_login.exe
```

è¿™æ˜¯ä½ è¦æ”¾è¿›è‡ªå¯åŠ¨çš„æ–‡ä»¶ã€‚

------

# ğŸ“Œ **ä¸‰ã€å¼€æœºè‡ªåŠ¨å¯åŠ¨ï¼ˆæœ€ç¨³å®šæ–¹æ³•ï¼‰**

æŠŠç”Ÿæˆçš„ exe å¤åˆ¶åˆ°ï¼š

```
C:\Users\ä½ çš„ç”¨æˆ·å\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup
```

æˆ–åœ¨â€œshell:startupâ€é‡Œæ”¾è¿›å»ï¼š

1. Win + R
2. è¾“å…¥ï¼š`shell:startup`
3. æŠŠ `auto_hfut_login.exe` æ‹–è¿›å»

å³å¯å¼€æœºè‡ªåŠ¨é™é»˜è¿è¡Œã€‚

------

# ğŸ’¡ **å››ã€è¯´æ˜**

âœ” è‡ªåŠ¨åˆ¤æ–­æ˜¯å¦æ’æœ‰çº¿ç½‘
 âœ” è‹¥æœ‰ â†’ Drcom ç™»å½•
 âœ” è‹¥æ—  â†’ è‡ªåŠ¨è¿æ¥ hfut-wlan + è‡ªåŠ¨è®¤è¯
 âœ” ä¸å¼¹çª—ã€ä¸æ˜¾ç¤ºæ§åˆ¶å°
 âœ” ä¸éœ€è¦åˆ¤æ–­æ‰çº¿
 âœ” å¯ç›´æ¥æ”¾è¿›å¼€æœºå¯åŠ¨é¡¹

------

